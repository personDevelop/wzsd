@using MVCExtention;
@{
    ViewBag.Title = "行政区域";
}

<!--工具栏-->
<div id="floatHead" class="toolbar-wrap">
    <div class="toolbar">
        <div class="box-wrap">
            <a class="menu-btn"></a>
            <div class="l-list">
                <ul class="icon-list">
                    <li><a class="add" href="@Url.Action("Edit")"><i></i><span>新增</span></a></li>
                    <li><a class="add" href="javascript:;" onclick="EditTree('treeGrid', '@Url.Action("Edit")');"><i></i><span>编辑</span></a></li>
                    <li><a class="del" href="javascript:;" onclick="DelTree('treeGrid', '@Url.Action("Delete")');"><i></i><span>删除</span></a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!--/工具栏-->
<!--列表-->
<div class="table-container">
    <div id="treeGrid">
    </div>
</div>
<!--/列表-->
@section  scripts{

    <script type="text/javascript">
        $(document).ready(function () {
            var url = "@Url.Action("GetList")";
            var datafields = [{ name: 'ID' }, { name: 'ParentID' }, { name: 'Code' },

		{ name: 'Name' }, { name: 'ShotName' }, { name: 'Path' },

		{ name: 'FullPath' }, { name: 'Jb' }, { name: 'Qh' },

		{ name: 'ZipCode' }, { name: 'Note' }];
            var columns = [
     { text: '编号', dataField: 'Code', cellsalign: "left", width: 300 },

  { text: '名称', dataField: 'Name', cellsalign: "left", width: 200 },

  { text: '简称', dataField: 'ShotName', width: 100 },

  { text: '路径', dataField: 'Path', cellsalign: "left" }];
            CreateTree("treeGrid", url, datafields, columns, false, {
                virtualModeCreateRecords: function (expandedRecord, done) {
                    var dataAdapter = new $.jqx.dataAdapter(source,
                        {
                            formatData: function (data) {
                                if (expandedRecord == null) {
                                    data.parentID = 0;
                                }
                                else {
                                    data.parentID = expandedRecord.ID;
                                }
                                return data;
                            },
                            loadComplete: function () {
                                done(dataAdapter.records);
                            },
                            loadError: function (xhr, status, error) {
                                done(false);
                                throw new Error("http://services.odata.org: " + error.toString());
                            }
                        }
                    );
                    dataAdapter.dataBind();
                }
            });

        });
    </script>
}
