@using MVCExtention;
@{
    ViewBag.Title = "商品咨询";
}
 
<!--工具栏-->
<div id="floatHead" class="toolbar-wrap">
    <div class="toolbar">
        <div class="box-wrap">
            <a class="menu-btn"></a>
            <div class="l-list">
                <ul class="icon-list"> 
                     <li><a class="reply" href="javascript:;" onclick="EditGrid('jqxgrid', '@Url.Action("Edit")');"><i></i><span>答复</span></a></li>
                    <li><a class="edit" href="javascript:;" onclick="DelGrid('jqxgrid', '@Url.Action("ApprovalNotPass")');"><i></i><span>批量屏蔽</span></a></li>
                      <li><a class="del" href="javascript:;" onclick="DelGrid('jqxgrid', '@Url.Action("Delete")');"><i></i><span>批量删除</span></a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!--/工具栏-->
<!--列表-->
<dl>
    <dt>

    </dt>
    <dd>
        <table class="borderkuang" border="0" cellspacing="0" cellpadding="0">
             
                <tr>
                    <td width="80" >
                        @HelperExtend.img("icon-1.gif", "width:19px,height:19px;margin-top:5px") 搜索 
                    </td>
                    <td  >
                        咨询商品：
                   
                        <input type="text" id="ShopProduct">

                    </td>
                    <td  >
                        咨询日期：
                    </td>
                    <td>

                        <div id='StartDate'>  </div>

                    </td>
                    <td width="5">
                        - 
                    </td>
                    <td>

                        <div id='EndDate'>  </div>

                    </td>
                    <td >状态：</td>
                    <td height="35">
                        @HelperExtend.DropDownListEnum("QryDjStatus", enumType: typeof(EasyCms.Model.CommentStatus))
                    </td> 
                    <td  colspan="2" ><input type="checkbox" id="OnlyWebUser" checked="checked" />只显示用户咨询
                        <input id="btnQry" type="button" value="搜索"></td>
                  
                </tr> 
        </table>
    </dd>
</dl>
<div class="table-container">
    <div id="jqxgrid"></div>
</div> 
<!--/列表-->
@section  scripts{

    <script type="text/javascript">
       
        $(function () {
            $("#StartDate").jqxDateTimeInput({ formatString: "yyyy-MM-dd", width: 100, height: '25px', showCalendarButton: true });
            $("#EndDate").jqxDateTimeInput({ formatString: "yyyy-MM-dd", width: 100, height: '25px', showCalendarButton: true });
            $("#QryDjStatus").jqxDropDownList('uncheckAll');
            
            $('#EndDate').jqxDateTimeInput('setDate', new Date());
            $('#StartDate').jqxDateTimeInput('setDate', get3MonthBefor());
            $("#btnQry").jqxButton({ width: '150', template: 'success' });
            $("#btnQry").on("click", function () {
                $('#jqxgrid').jqxGrid('updatebounddata');
            });
           

        });


    </script>

    <script type="text/javascript">

        $(document).ready(function () {
            var url = "@Url.Action("GetList")";
            var deleteUrl = "@Url.Action("Delete")";
            var editUrl = "@Url.Action("Edit")";
            var datafields = [
      { name: 'ID' },
    { name: 'ReviewText' },
          { name: 'ProductId' },
                { name: 'UserId' },
            { name: 'Status' },
            { name: 'OrderId' },
            { name: 'ProductName' },
            { name: 'Name' },
              { name: 'hasReply' }, { name: 'CommentOrder' },
            { name: 'CreatedDate' },
      { name: 'IsManager' }];
            var columns = [
                  { text: '咨询等级', dataField: 'CommentOrder',@HelperExtend.ParseEnum(typeof(EasyCms.Model.CommentOrder)) },
    { text: '咨询内容', dataField: 'ReviewText', cellsalign: "left" },
    { text: '商品', dataField: 'ProductName', cellsalign: "left", width: 200 },
    { text: '咨询人', dataField: 'Name', cellsalign: "left", width: 100 },
     { text: '是管理员', dataField: 'IsManager', width: 100,@HelperExtend.Parsebool() },
      { text: '已回复', dataField: 'hasReply', width: 100,@HelperExtend.Parsebool() },
    { text: '咨询时间', dataField: 'CreatedDate', width: 130, cellsformat: "yyyy-MM-dd HH:mm" },
    { text: '状态', dataField: 'Status',   width: 100,@HelperExtend.ParseEnum(typeof(EasyCms.Model.DjStatus)) },
     {
         text: '操作', datafield: 'ID', width: 200, cellsrenderer: function (row, column, value) {

             var html = "  <div style='text-align: center; overflow: hidden; padding-bottom: 2px; margin-top: 4px; text-overflow: ellipsis;'>";
             html +=
                  "<a href='javascript:;' onclick='EditGrid(\"jqxgrid\",\"" + editUrl + "\",\"" + value + "\");'  >详细信息</a> &nbsp;&nbsp;&nbsp;" +
              "<a  href='javascript:;' onclick='DelGrid(\"jqxgrid\",\"" + deleteUrl + "\",\"" + value + "\");'  >删除</a>";
             html += "</div>";

             return html;
         }
     }];

            CreateGrid("jqxgrid", url, datafields, columns, {
                isMutilSelect: true,
                adapter: {
                    formatData: function (data) {
                        data.StartDate = $("#StartDate").val();
                        data.EndDate = $("#EndDate").val();
                        data.ShopProduct = $("#ShopProduct").val();
                        data.QryDjStatus = $("#QryDjStatus").val();
                        data.QryCommentOrder = $("#QryCommentOrder").val();
                        data.OnlyWebUser = $("#OnlyWebUser").prop("checked");
                     
                    }

                }, grid: { localization: "zh-Hans" }
            });
        });
       
    </script>
}

